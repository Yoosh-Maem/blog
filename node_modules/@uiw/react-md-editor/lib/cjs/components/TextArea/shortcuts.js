"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = shortcutsHandle;

var _objectSpread2 = _interopRequireDefault(require("@babel/runtime/helpers/objectSpread2"));

function getCommands() {
  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  var resulte = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  data.forEach(function (item) {
    if (item.children && Array.isArray(item.children)) {
      resulte = (0, _objectSpread2.default)((0, _objectSpread2.default)({}, resulte), getCommands(item.children || []));
    } else if (item.keyCommand && item.shortcuts && item.execute) {
      resulte[item.shortcuts.toLocaleLowerCase()] = item;
    }
  });
  return resulte;
}

function shortcutsHandle(e) {
  var commands = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
  var commandOrchestrator = arguments.length > 2 ? arguments[2] : undefined;
  var data = getCommands(commands || []);
  var shortcuts = [];

  if (e.altKey) {
    shortcuts.push('alt');
  }

  if (e.shiftKey) {
    shortcuts.push('shift');
  }

  if (e.metaKey) {
    shortcuts.push('cmd');
  }

  if (e.ctrlKey) {
    shortcuts.push('ctrl');
  }

  if (shortcuts.length > 0 && !/(control|alt|meta|shift)/.test(e.key.toLocaleLowerCase())) {
    shortcuts.push(e.key.toLocaleLowerCase());
  }

  if (shortcuts.length < 2) {
    return;
  }

  var equal = !!data[shortcuts.join('+')];
  var command = equal ? data[shortcuts.join('+')] : undefined;
  Object.keys(data).forEach(function (item) {
    var isequal = item.split('+').every(function (v) {
      if (/ctrlcmd/.test(v)) {
        return shortcuts.includes('ctrl') || shortcuts.includes('cmd');
      }

      return shortcuts.includes(v);
    });

    if (isequal) {
      command = data[item];
    }
  });

  if (command && commandOrchestrator) {
    e.stopPropagation();
    e.preventDefault();
    commandOrchestrator.executeCommand(command);
    return;
  }
}

module.exports = exports.default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL1RleHRBcmVhL3Nob3J0Y3V0cy50cyJdLCJuYW1lcyI6WyJnZXRDb21tYW5kcyIsImRhdGEiLCJyZXN1bHRlIiwiZm9yRWFjaCIsIml0ZW0iLCJjaGlsZHJlbiIsIkFycmF5IiwiaXNBcnJheSIsImtleUNvbW1hbmQiLCJzaG9ydGN1dHMiLCJleGVjdXRlIiwidG9Mb2NhbGVMb3dlckNhc2UiLCJzaG9ydGN1dHNIYW5kbGUiLCJlIiwiY29tbWFuZHMiLCJjb21tYW5kT3JjaGVzdHJhdG9yIiwiYWx0S2V5IiwicHVzaCIsInNoaWZ0S2V5IiwibWV0YUtleSIsImN0cmxLZXkiLCJsZW5ndGgiLCJ0ZXN0Iiwia2V5IiwiZXF1YWwiLCJqb2luIiwiY29tbWFuZCIsInVuZGVmaW5lZCIsIk9iamVjdCIsImtleXMiLCJpc2VxdWFsIiwic3BsaXQiLCJldmVyeSIsInYiLCJpbmNsdWRlcyIsInN0b3BQcm9wYWdhdGlvbiIsInByZXZlbnREZWZhdWx0IiwiZXhlY3V0ZUNvbW1hbmQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBRUEsU0FBU0EsV0FBVCxHQUE4RztBQUFBLE1BQXpGQyxJQUF5Rix1RUFBdEUsRUFBc0U7QUFBQSxNQUFsRUMsT0FBa0UsdUVBQTlCLEVBQThCO0FBQzVHRCxFQUFBQSxJQUFJLENBQUNFLE9BQUwsQ0FBYSxVQUFDQyxJQUFELEVBQVU7QUFDckIsUUFBSUEsSUFBSSxDQUFDQyxRQUFMLElBQWlCQyxLQUFLLENBQUNDLE9BQU4sQ0FBY0gsSUFBSSxDQUFDQyxRQUFuQixDQUFyQixFQUFtRDtBQUNqREgsTUFBQUEsT0FBTywrREFBUUEsT0FBUixHQUFvQkYsV0FBVyxDQUFDSSxJQUFJLENBQUNDLFFBQUwsSUFBaUIsRUFBbEIsQ0FBL0IsQ0FBUDtBQUNELEtBRkQsTUFFTyxJQUFJRCxJQUFJLENBQUNJLFVBQUwsSUFBbUJKLElBQUksQ0FBQ0ssU0FBeEIsSUFBcUNMLElBQUksQ0FBQ00sT0FBOUMsRUFBdUQ7QUFDNURSLE1BQUFBLE9BQU8sQ0FBQ0UsSUFBSSxDQUFDSyxTQUFMLENBQWVFLGlCQUFmLEVBQUQsQ0FBUCxHQUE4Q1AsSUFBOUM7QUFDRDtBQUNGLEdBTkQ7QUFPQSxTQUFPRixPQUFQO0FBQ0Q7O0FBRWMsU0FBU1UsZUFBVCxDQUNiQyxDQURhLEVBSWI7QUFBQSxNQUZBQyxRQUVBLHVFQUZ1QixFQUV2QjtBQUFBLE1BREFDLG1CQUNBO0FBQ0EsTUFBTWQsSUFBSSxHQUFHRCxXQUFXLENBQUNjLFFBQVEsSUFBSSxFQUFiLENBQXhCO0FBQ0EsTUFBTUwsU0FBOEIsR0FBRyxFQUF2Qzs7QUFDQSxNQUFJSSxDQUFDLENBQUNHLE1BQU4sRUFBYztBQUNaUCxJQUFBQSxTQUFTLENBQUNRLElBQVYsQ0FBZSxLQUFmO0FBQ0Q7O0FBQ0QsTUFBSUosQ0FBQyxDQUFDSyxRQUFOLEVBQWdCO0FBQ2RULElBQUFBLFNBQVMsQ0FBQ1EsSUFBVixDQUFlLE9BQWY7QUFDRDs7QUFDRCxNQUFJSixDQUFDLENBQUNNLE9BQU4sRUFBZTtBQUNiVixJQUFBQSxTQUFTLENBQUNRLElBQVYsQ0FBZSxLQUFmO0FBQ0Q7O0FBQ0QsTUFBSUosQ0FBQyxDQUFDTyxPQUFOLEVBQWU7QUFDYlgsSUFBQUEsU0FBUyxDQUFDUSxJQUFWLENBQWUsTUFBZjtBQUNEOztBQUNELE1BQUlSLFNBQVMsQ0FBQ1ksTUFBVixHQUFtQixDQUFuQixJQUF3QixDQUFDLDJCQUEyQkMsSUFBM0IsQ0FBZ0NULENBQUMsQ0FBQ1UsR0FBRixDQUFNWixpQkFBTixFQUFoQyxDQUE3QixFQUF5RjtBQUN2RkYsSUFBQUEsU0FBUyxDQUFDUSxJQUFWLENBQWVKLENBQUMsQ0FBQ1UsR0FBRixDQUFNWixpQkFBTixFQUFmO0FBQ0Q7O0FBQ0QsTUFBSUYsU0FBUyxDQUFDWSxNQUFWLEdBQW1CLENBQXZCLEVBQTBCO0FBQ3hCO0FBQ0Q7O0FBRUQsTUFBSUcsS0FBSyxHQUFHLENBQUMsQ0FBQ3ZCLElBQUksQ0FBQ1EsU0FBUyxDQUFDZ0IsSUFBVixDQUFlLEdBQWYsQ0FBRCxDQUFsQjtBQUNBLE1BQUlDLE9BQU8sR0FBR0YsS0FBSyxHQUFHdkIsSUFBSSxDQUFDUSxTQUFTLENBQUNnQixJQUFWLENBQWUsR0FBZixDQUFELENBQVAsR0FBK0JFLFNBQWxEO0FBRUFDLEVBQUFBLE1BQU0sQ0FBQ0MsSUFBUCxDQUFZNUIsSUFBWixFQUFrQkUsT0FBbEIsQ0FBMEIsVUFBQ0MsSUFBRCxFQUFVO0FBQ2xDLFFBQU0wQixPQUFPLEdBQUcxQixJQUFJLENBQUMyQixLQUFMLENBQVcsR0FBWCxFQUFnQkMsS0FBaEIsQ0FBc0IsVUFBQ0MsQ0FBRCxFQUFPO0FBQzNDLFVBQUksVUFBVVgsSUFBVixDQUFlVyxDQUFmLENBQUosRUFBdUI7QUFDckIsZUFBT3hCLFNBQVMsQ0FBQ3lCLFFBQVYsQ0FBbUIsTUFBbkIsS0FBOEJ6QixTQUFTLENBQUN5QixRQUFWLENBQW1CLEtBQW5CLENBQXJDO0FBQ0Q7O0FBQ0QsYUFBT3pCLFNBQVMsQ0FBQ3lCLFFBQVYsQ0FBbUJELENBQW5CLENBQVA7QUFDRCxLQUxlLENBQWhCOztBQU1BLFFBQUlILE9BQUosRUFBYTtBQUNYSixNQUFBQSxPQUFPLEdBQUd6QixJQUFJLENBQUNHLElBQUQsQ0FBZDtBQUNEO0FBQ0YsR0FWRDs7QUFXQSxNQUFJc0IsT0FBTyxJQUFJWCxtQkFBZixFQUFvQztBQUNsQ0YsSUFBQUEsQ0FBQyxDQUFDc0IsZUFBRjtBQUNBdEIsSUFBQUEsQ0FBQyxDQUFDdUIsY0FBRjtBQUNBckIsSUFBQUEsbUJBQW1CLENBQUNzQixjQUFwQixDQUFtQ1gsT0FBbkM7QUFDQTtBQUNEO0FBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJQ29tbWFuZCwgVGV4dEFyZWFDb21tYW5kT3JjaGVzdHJhdG9yIH0gZnJvbSAnLi4vLi4vY29tbWFuZHMnO1xuXG5mdW5jdGlvbiBnZXRDb21tYW5kcyhkYXRhOiBJQ29tbWFuZFtdID0gW10sIHJlc3VsdGU6IFJlY29yZDxzdHJpbmcsIElDb21tYW5kPiA9IHt9KTogUmVjb3JkPHN0cmluZywgSUNvbW1hbmQ+IHtcbiAgZGF0YS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgaWYgKGl0ZW0uY2hpbGRyZW4gJiYgQXJyYXkuaXNBcnJheShpdGVtLmNoaWxkcmVuKSkge1xuICAgICAgcmVzdWx0ZSA9IHsgLi4ucmVzdWx0ZSwgLi4uZ2V0Q29tbWFuZHMoaXRlbS5jaGlsZHJlbiB8fCBbXSkgfTtcbiAgICB9IGVsc2UgaWYgKGl0ZW0ua2V5Q29tbWFuZCAmJiBpdGVtLnNob3J0Y3V0cyAmJiBpdGVtLmV4ZWN1dGUpIHtcbiAgICAgIHJlc3VsdGVbaXRlbS5zaG9ydGN1dHMudG9Mb2NhbGVMb3dlckNhc2UoKV0gPSBpdGVtO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiByZXN1bHRlO1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBzaG9ydGN1dHNIYW5kbGUoXG4gIGU6IFJlYWN0LktleWJvYXJkRXZlbnQ8SFRNTFRleHRBcmVhRWxlbWVudD4sXG4gIGNvbW1hbmRzOiBJQ29tbWFuZFtdID0gW10sXG4gIGNvbW1hbmRPcmNoZXN0cmF0b3I/OiBUZXh0QXJlYUNvbW1hbmRPcmNoZXN0cmF0b3IsXG4pIHtcbiAgY29uc3QgZGF0YSA9IGdldENvbW1hbmRzKGNvbW1hbmRzIHx8IFtdKTtcbiAgY29uc3Qgc2hvcnRjdXRzOiAoc3RyaW5nIHwgbnVtYmVyKVtdID0gW107XG4gIGlmIChlLmFsdEtleSkge1xuICAgIHNob3J0Y3V0cy5wdXNoKCdhbHQnKTtcbiAgfVxuICBpZiAoZS5zaGlmdEtleSkge1xuICAgIHNob3J0Y3V0cy5wdXNoKCdzaGlmdCcpO1xuICB9XG4gIGlmIChlLm1ldGFLZXkpIHtcbiAgICBzaG9ydGN1dHMucHVzaCgnY21kJyk7XG4gIH1cbiAgaWYgKGUuY3RybEtleSkge1xuICAgIHNob3J0Y3V0cy5wdXNoKCdjdHJsJyk7XG4gIH1cbiAgaWYgKHNob3J0Y3V0cy5sZW5ndGggPiAwICYmICEvKGNvbnRyb2x8YWx0fG1ldGF8c2hpZnQpLy50ZXN0KGUua2V5LnRvTG9jYWxlTG93ZXJDYXNlKCkpKSB7XG4gICAgc2hvcnRjdXRzLnB1c2goZS5rZXkudG9Mb2NhbGVMb3dlckNhc2UoKSk7XG4gIH1cbiAgaWYgKHNob3J0Y3V0cy5sZW5ndGggPCAyKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbGV0IGVxdWFsID0gISFkYXRhW3Nob3J0Y3V0cy5qb2luKCcrJyldO1xuICBsZXQgY29tbWFuZCA9IGVxdWFsID8gZGF0YVtzaG9ydGN1dHMuam9pbignKycpXSA6IHVuZGVmaW5lZDtcblxuICBPYmplY3Qua2V5cyhkYXRhKS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgY29uc3QgaXNlcXVhbCA9IGl0ZW0uc3BsaXQoJysnKS5ldmVyeSgodikgPT4ge1xuICAgICAgaWYgKC9jdHJsY21kLy50ZXN0KHYpKSB7XG4gICAgICAgIHJldHVybiBzaG9ydGN1dHMuaW5jbHVkZXMoJ2N0cmwnKSB8fCBzaG9ydGN1dHMuaW5jbHVkZXMoJ2NtZCcpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHNob3J0Y3V0cy5pbmNsdWRlcyh2KTtcbiAgICB9KTtcbiAgICBpZiAoaXNlcXVhbCkge1xuICAgICAgY29tbWFuZCA9IGRhdGFbaXRlbV07XG4gICAgfVxuICB9KTtcbiAgaWYgKGNvbW1hbmQgJiYgY29tbWFuZE9yY2hlc3RyYXRvcikge1xuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbW1hbmRPcmNoZXN0cmF0b3IuZXhlY3V0ZUNvbW1hbmQoY29tbWFuZCk7XG4gICAgcmV0dXJuO1xuICB9XG59XG4iXX0=